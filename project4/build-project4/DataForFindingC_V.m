% Estimating the critical temperature using computed values of C_V
% calculated in the interval T = [2.2, 2.3] with ?T = 0.001

e_var40 = [7.0544, 6.95435, 6.81847, 7.25714, 7.17717, 7.05918, 7.09043, 6.94648, 7.2567, 7.25731, 7.20246, 7.1858, 7.25374, 7.18337, 7.5103, 7.76607, 7.44289, 7.40967, 7.89653, 7.66604, 7.86142, 8.04335, 7.70861, 8.01945, 8.10895, 8.2504, 8.01684, 8.41529, 7.92981, 7.9585, 8.38762, 8.0218, 8.52928, 8.50725, 8.33875, 8.53054, 8.36859, 8.44004, 8.46884, 8.70606, 8.60629, 8.76457, 8.92472, 8.73049, 8.97007, 9.42676, 9.12826, 9.14644, 9.19512, 9.25887, 9.27466, 9.66381, 9.17605, 9.45269, 9.49198, 9.47044, 9.63296, 9.4178, 9.52984, 9.71089, 9.51712, 9.66399, 9.43286, 9.92841, 10.1647, 10.1957, 9.69566, 10.1301, 9.84321, 10.2647, 10.0345, 10.0283, 9.95989, 9.84073, 10.4655, 10.1643, 10.0282, 10.2837, 10.4173, 10.4879, 10.2081, 10.4978, 10.3296, 10.312, 10.4728, 10.4555, 10.5438, 10.6536, 10.4964, 10.5361, 10.41, 10.698, 10.6193, 10.4804, 10.4866, 10.6222, 10.5803, 10.4777, 10.6247, 10.5857, ];
e_var60 = [6.93757, 6.8341, 6.82556, 7.04553, 6.92715, 7.17373, 7.05168, 7.01145, 7.30881, 7.20725, 7.27486, 7.46082, 7.2815, 7.27769, 7.35437, 7.45857, 7.44109, 7.7853, 8.01018, 7.79349, 7.85073, 8.05232, 8.01155, 7.88924, 8.08786, 8.36911, 7.98743, 8.23747, 8.01202, 8.2343, 8.23872, 8.39885, 8.62049, 8.47086, 8.81101, 8.63109, 8.42695, 8.80018, 8.98039, 9.38183, 9.13768, 9.37962, 9.12563, 9.38414, 9.51592, 9.30437, 9.28252, 9.79603, 9.54977, 10.0011, 9.9206, 9.73511, 10.3019, 10.3025, 10.2535, 10.3356, 10.4678, 10.5307, 10.4901, 10.2492, 10.8213, 10.5412, 10.7068, 10.8101, 11.2785, 10.9137, 11.0362, 10.9512, 10.7403, 10.7421, 11.2881, 11.0977, 11.0368, 11.237, 11.3789, 11.4671, 11.6437, 11.4659, 11.4193, 11.291, 11.563, 11.6311, 11.6321, 11.4045, 11.5084, 11.4259, 11.5751, 11.6268, 11.4518, 11.4399, 11.8096, 11.5399, 11.4409, 11.5605, 11.4145, 11.352, 11.3152, 11.2731, 11.2447, 11.2147, ];
e_var80 = [7.00589, 6.97983, 6.91514, 6.81056, 7.03266, 7.13597, 7.20698, 6.99378, 7.27799, 7.26922, 7.32961, 7.3328, 7.49865, 7.49146, 7.72134, 7.40471, 7.75685, 7.63351, 7.8429, 7.79176, 7.80414, 7.74315, 7.92146, 7.77183, 8.29371, 8.3777, 8.15193, 8.16965, 8.37213, 8.38723, 8.27363, 8.4573, 8.55199, 8.54901, 8.67598, 8.80077, 8.86571, 8.74431, 9.31612, 9.08322, 9.20077, 9.23059, 9.30059, 9.6511, 9.35546, 9.54366, 9.68904, 9.88482, 10.303, 10.0684, 10.4616, 9.61008, 10.214, 10.9194, 10.1821, 10.4114, 10.368, 10.5014, 10.5702, 11.0149, 11.0658, 10.9487, 11.0838, 11.5061, 11.5137, 11.1235, 11.7275, 11.9821, 11.6838, 11.7871, 11.9049, 12.1043, 12.1823, 12.0433, 12.4237, 12.3826, 12.0596, 12.2298, 12.0973, 12.389, 12.3789, 12.096, 12.4251, 12.4708, 12.4525, 12.0739, 12.0324, 12.2041, 12.0338, 12.1425, 11.9362, 11.8598, 11.7788, 11.6926, 11.6028, 11.7312, 11.9043, 11.3438, 11.1548, 11.3502, ];
e_var100 = [7.35975, 6.85626, 6.97843, 7.13257, 6.90139, 6.99616, 7.17744, 7.26985, 7.07388, 7.25939, 7.78061, 7.34681, 7.54705, 7.5867, 7.48698, 7.51819, 7.50293, 7.64885, 7.63972, 7.71405, 8.4967, 7.72743, 7.87165, 8.05257, 8.1039, 8.25631, 9.24903, 8.08723, 8.53866, 8.27088, 8.82524, 8.48131, 8.37696, 8.78395, 8.84667, 9.03567, 8.67721, 9.60781, 9.01658, 9.28395, 9.03489, 9.2822, 9.45573, 10.2107, 9.46818, 9.5728, 9.71961, 10.1861, 10.1863, 11.0595, 10.2527, 10.3977, 10.0825, 11.169, 9.74486, 11.0519, 10.9868, 10.435, 11.3964, 11.4735, 11.1353, 12.5478, 11.4907, 11.6195, 11.8876, 11.282, 12.3865, 12.2639, 11.8102, 12.5525, 11.9138, 12.4642, 12.4954, 12.0799, 12.4073, 12.4419, 13.0176, 13.2204, 12.7685, 12.5567, ];

temperatures = [2.2, 2.201, 2.202, 2.203, 2.204, 2.205, 2.206, 2.207, 2.208, 2.209, 2.21, 2.211, 2.212, 2.213, 2.214, 2.215, 2.216, 2.217, 2.218, 2.219, 2.22, 2.221, 2.222, 2.223, 2.224, 2.225, 2.226, 2.227, 2.228, 2.229, 2.23, 2.231, 2.232, 2.233, 2.234, 2.235, 2.236, 2.237, 2.238, 2.239, 2.24, 2.241, 2.242, 2.243, 2.244, 2.245, 2.246, 2.247, 2.248, 2.249, 2.25, 2.251, 2.252, 2.253, 2.254, 2.255, 2.256, 2.257, 2.258, 2.259, 2.26, 2.261, 2.262, 2.263, 2.264, 2.265, 2.266, 2.267, 2.268, 2.269, 2.27, 2.271, 2.272, 2.273, 2.274, 2.275, 2.276, 2.277, 2.278, 2.279, 2.28, 2.281, 2.282, 2.283, 2.284, 2.285, 2.286, 2.287, 2.288, 2.289, 2.29, 2.291, 2.292, 2.293, 2.294, 2.295, 2.296, 2.297, 2.298, 2.299, ];
temperatures100 = [2.2, 2.201, 2.202, 2.203, 2.204, 2.205, 2.206, 2.207, 2.208, 2.209, 2.21, 2.211, 2.212, 2.213, 2.214, 2.215, 2.216, 2.217, 2.218, 2.219, 2.22, 2.221, 2.222, 2.223, 2.224, 2.225, 2.226, 2.227, 2.228, 2.229, 2.23, 2.231, 2.232, 2.233, 2.234, 2.235, 2.236, 2.237, 2.238, 2.239, 2.24, 2.241, 2.242, 2.243, 2.244, 2.245, 2.246, 2.247, 2.248, 2.249, 2.25, 2.251, 2.252, 2.253, 2.254, 2.255, 2.256, 2.257, 2.258, 2.259, 2.26, 2.261, 2.262, 2.263, 2.264, 2.265, 2.266, 2.267, 2.268, 2.269, 2.27, 2.271, 2.272, 2.273, 2.274, 2.275, 2.276, 2.277, 2.278, 2.279, ];

plot(temperatures100,e_var100)

e_var60 = e_var60./temperatures.^2;
e_var40 = e_var40./temperatures.^2;
e_var100 = e_var100./temperatures100.^2;
e_var80 = e_var80./temperatures.^2;


[maks_chi_L100, i100] = max(e_var100);
t_c = temperatures100(i100)
[maks_chi_L80, i80] = max(e_var80);
t_c = temperatures(i80);
[maks_chi_L60, i60] = max(e_var60);
t_c = temperatures(i60);
[maks_chi_L40, i40] = max(e_var40);
t_c = temperatures(i40);
% [maks_chi_L20, i20] = max(e_var20);
% t_c = temperatures(i20);

t_c_est = [temperatures(i40), temperatures(i60), temperatures(i80), temperatures100(i100)];
L = [40,60,80,100];
Linv = [1/40,1/60,1/80,1/100];

a1 = (temperatures100(i100) - temperatures(i80)) / (Linv(4) - Linv(3));
a2 = (temperatures100(i100) - temperatures(i60)) / (Linv(4) - Linv(2));
a3 = (temperatures100(i100) - temperatures(i40)) / (Linv(4) - Linv(1));
a6 = (temperatures(i80) - temperatures(i60)) / (Linv(3) - Linv(2));
a7 = (temperatures(i80) - temperatures(i40)) / (Linv(3) - Linv(1));
a8 = (temperatures(i60) - temperatures(i40)) / (Linv(2) - Linv(1));

a = (a1+a2+a3+a6+a7+a8)/6

T_C1 = temperatures100(i100) - a*Linv(4)

T_C = polyfit(L, t_c_est - a*Linv,1)
