from math import cosh, sinh, exp
import matplotlib.pylab as plt
from numpy import array, sum

MC = array([100000, 200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1e+06, 1.1e+06, 1.2e+06, 1.3e+06, 1.4e+06, 1.5e+06, 1.6e+06, 1.7e+06, 1.8e+06, 1.9e+06, 2e+06, 2.1e+06, 2.2e+06, 2.3e+06, 2.4e+06, 2.5e+06, 2.6e+06, 2.7e+06, 2.8e+06, 2.9e+06, 3e+06, 3.1e+06, 3.2e+06, 3.3e+06, 3.4e+06, 3.5e+06, 3.6e+06, 3.7e+06, 3.8e+06, 3.9e+06, 4e+06, 4.1e+06, 4.2e+06, 4.3e+06, 4.4e+06, 4.5e+06, 4.6e+06, 4.7e+06, 4.8e+06, 4.9e+06, 5e+06, 5.1e+06, 5.2e+06, 5.3e+06, 5.4e+06, 5.5e+06, 5.6e+06, 5.7e+06, 5.8e+06, 5.9e+06, 6e+06, 6.1e+06, 6.2e+06, 6.3e+06, 6.4e+06, 6.5e+06, 6.6e+06, 6.7e+06, 6.8e+06, 6.9e+06, 7e+06, 7.1e+06, 7.2e+06, 7.3e+06, 7.4e+06, 7.5e+06, 7.6e+06, 7.7e+06, 7.8e+06, 7.9e+06, 8e+06, 8.1e+06, 8.2e+06, 8.3e+06, 8.4e+06, 8.5e+06, 8.6e+06, 8.7e+06, 8.8e+06, 8.9e+06, 9e+06, 9.1e+06, 9.2e+06, 9.3e+06, 9.4e+06, 9.5e+06, 9.6e+06, 9.7e+06, 9.8e+06, 9.9e+06, 1e+07, ])
e_var = array([0.0268348, 0.0300234, 0.0299172, 0.0316571, 0.032191, 0.0312188, 0.0315034, 0.0320555, 0.0319714, 0.0323663, 0.0321678, 0.0324937, 0.0320096, 0.032084, 0.0323078, 0.0322248, 0.0325265, 0.0325557, 0.0329592, 0.0329797, 0.0329073, 0.0327255, 0.0325457, 0.0325203, 0.032344, 0.032175, 0.0322193, 0.0322775, 0.0322932, 0.0322282, 0.0322084, 0.0322896, 0.0321292, 0.0322547, 0.0321955, 0.0320511, 0.0321298, 0.032087, 0.03203, 0.0322069, 0.0321848, 0.0320233, 0.0319508, 0.0318853, 0.0318793, 0.0319117, 0.0317563, 0.0316671, 0.0318417, 0.0318754, 0.0319329, 0.0319758, 0.0318909, 0.031936, 0.0318896, 0.0318421, 0.0317738, 0.0317574, 0.0318685, 0.0318643, 0.0318733, 0.031918, 0.0320852, 0.0321427, 0.0321272, 0.0320012, 0.0321096, 0.0321352, 0.032227, 0.0322615, 0.0322592, 0.0322326, 0.0322787, 0.0322332, 0.0321506, 0.0321205, 0.0321388, 0.0321587, 0.0321175, 0.0320356, 0.0320698, 0.0320429, 0.032055, 0.0320612, 0.0321891, 0.0321639, 0.0321192, 0.0320772, 0.0320363, 0.0320086, 0.0320096, 0.0319914, 0.0319891, 0.0319394, 0.0320081, 0.0320074, 0.0319738, 0.0319344, 0.0319312, 0.0319408, ])
m_var = array([0.00341489, 0.00374872, 0.00377703, 0.0040753, 0.00405472, 0.00395312, 0.00399726, 0.00409643, 0.00408827, 0.00414053, 0.00411534, 0.00413501, 0.00405353, 0.00405917, 0.00408996, 0.00407143, 0.004119, 0.00410311, 0.00414239, 0.00415935, 0.0041405, 0.00410387, 0.0040878, 0.00410298, 0.00407745, 0.0040581, 0.0040627, 0.00406483, 0.00404788, 0.00404406, 0.00404499, 0.00405676, 0.00402763, 0.00405447, 0.00405329, 0.00403251, 0.00404411, 0.00403988, 0.00402947, 0.00405422, 0.00404688, 0.00403185, 0.00401772, 0.00400992, 0.003998, 0.00399485, 0.0039719, 0.00396425, 0.00398843, 0.00399729, 0.00400091, 0.00400421, 0.00399215, 0.00400564, 0.00400052, 0.00399327, 0.00398907, 0.00398656, 0.00399764, 0.0039969, 0.00399601, 0.00400175, 0.0040293, 0.00403215, 0.00403001, 0.00401057, 0.00402667, 0.00402719, 0.00403536, 0.00404287, 0.00404498, 0.00403802, 0.00404272, 0.00403396, 0.00402385, 0.00401793, 0.00401903, 0.00401946, 0.00401344, 0.0040031, 0.00400678, 0.00400041, 0.00400561, 0.0040114, 0.00403206, 0.00402615, 0.00401568, 0.00400658, 0.00400004, 0.00399509, 0.0040022, 0.00400177, 0.00400361, 0.00399703, 0.00400422, 0.00400296, 0.00399875, 0.00399513, 0.00399712, 0.00399928, ])
mean_mag = array([0.99887, 0.998748, 0.998745, 0.998659, 0.998651, 0.998688, 0.998675, 0.998647, 0.99865, 0.998633, 0.998641, 0.998631, 0.998655, 0.998653, 0.998643, 0.998648, 0.998633, 0.998635, 0.99862, 0.998617, 0.998622, 0.998632, 0.998638, 0.998636, 0.998644, 0.998651, 0.998649, 0.998648, 0.99865, 0.998652, 0.998652, 0.998649, 0.998657, 0.99865, 0.998651, 0.998658, 0.998654, 0.998656, 0.998659, 0.998651, 0.998652, 0.998658, 0.998662, 0.998665, 0.998667, 0.998667, 0.998674, 0.998677, 0.998669, 0.998667, 0.998665, 0.998664, 0.998668, 0.998665, 0.998666, 0.998669, 0.998671, 0.998671, 0.998667, 0.998668, 0.998667, 0.998666, 0.998657, 0.998656, 0.998656, 0.998662, 0.998657, 0.998657, 0.998653, 0.998652, 0.998651, 0.998653, 0.998651, 0.998654, 0.998657, 0.998659, 0.998658, 0.998658, 0.998659, 0.998663, 0.998662, 0.998663, 0.998662, 0.998661, 0.998655, 0.998656, 0.998659, 0.998661, 0.998663, 0.998665, 0.998664, 0.998664, 0.998664, 0.998666, 0.998663, 0.998663, 0.998665, 0.998666, 0.998666, 0.998665, ])

mean = array([0.00079, -0.0868825, -0.0836583, 0.00759375, 0.038353, 0.0516767, 0.0475336, 0.0598644, 0.0607589, 0.074066, 0.0661932, 0.0548954, 0.0433965, 0.0305268, 0.042214, 0.0220725, 0.030615, 0.0168281, 0.0119513, 0.013836, 0.0142912, 0.0116143, 0.0203963, 0.0246056, 0.0299668, 0.0265496, 0.0172483, 0.0181643, 0.0211038, 0.0243287, 0.0226535, 0.0197567, 0.0186398, 0.0193918, 0.0149771, 0.0142985, 0.0217695, 0.0179128, 0.0162417, 0.017597, 0.00996561, 0.0176381, 0.013395, 0.0090217, 0.00935833, 0.0076038, 0.00171479, -0.000439375, 7.7551e-05, 0.0012354, -7.89216e-05, -0.00267837, -0.00290415, -0.00255028, -0.00153964, 0.000733393, -0.00484702, -0.00129457, -0.0054422, -0.0054165, -0.00596385, -0.00953056, -0.00930508, -0.00970437, -0.004218, -0.00332053, -0.00356007, 0.00291309, 0.00472638, 0.00597921, 0.00257993, -0.000192083, -0.00496747, -0.0057898, -0.00993007, -0.011207, -0.00839779, -0.00842436, -0.00882905, -0.013346, -0.0150887, -0.0126639, -0.0101627, -0.0113214, -0.0109242, -0.00869576, -0.00988201, -0.00866085, -0.00696494, -0.00494011, -0.00469522, -0.00823717, -0.00940656, -0.00912814, -0.0107279, -0.00998089, -0.00902665, -0.00873684, -0.00893626, -0.0074743, ])

time_used = array([0.068371, 0.13444, 0.199839, 0.264818, 0.333032, 0.399589, 0.466165, 0.532138, 0.59712, 0.665501, 0.730893, 0.796205, 0.861671, 0.928191, 0.992399, 1.05702, 1.124, 1.19442, 1.27139, 1.33888, 1.4077, 1.47521, 1.54021, 1.60594, 1.67224, 1.7382, 1.80327, 1.86977, 1.93481, 2.0028, 2.06661, 2.13282, 2.19812, 2.26272, 2.32735, 2.39201, 2.45733, 2.5227, 2.59231, 2.65806, 2.7263, 2.79208, 2.85812, 2.9253, 2.9883, 3.05408, 3.12096, 3.18739, 3.25089, 3.31652, 3.38236, 3.44737, 3.5133, 3.58152, 3.64589, 3.71218, 3.77833, 3.84481, 3.90991, 3.97705, 4.04247, 4.10926, 4.17492, 4.2408, 4.30682, 4.37476, 4.43991, 4.50696, 4.57313, 4.64006, 4.70772, 4.77371, 4.83766, 4.90312, 4.96919, 5.03512, 5.09943, 5.16456, 5.22977, 5.29758, 5.36202, 5.42668, 5.49566, 5.56236, 5.62786, 5.69603, 5.76333, 5.82912, 5.89476, 5.95977, 6.02674, 6.0938, 6.16004, 6.22642, 6.29359, 6.36234, 6.43155, 6.49804, 6.56703, 6.6312, ])
accepted_states = array([0.00682, 0.00434, 0.00260667, 0.00224, 0.001796, 0.0011, 0.00122, 0.0010725, 0.000875556, 0.00089, 0.000687273, 0.000731667, 0.000518462, 0.000612857, 0.000574667, 0.00048375, 0.000557647, 0.000448889, 0.000507368, 0.000408, 0.000358095, 0.000348182, 0.000309565, 0.000326667, 0.0002856, 0.000286923, 0.000312593, 0.000301429, 0.000281379, 0.000256667, 0.000263871, 0.000285, 0.00019697, 0.000260588, 0.000216, 0.000184444, 0.000231892, 0.000202105, 0.000190769, 0.0002425, 0.000197561, 0.00015619, 0.000165581, 0.000167273, 0.000180889, 0.000172174, 0.000137021, 0.0001425, 0.000195918, 0.0001728, 0.000169412, 0.000166538, 0.000133585, 0.000155185, 0.000135636, 0.000132857, 0.000127018, 0.00012931, 0.000149831, 0.000136, 0.00013541, 0.000147097, 0.000167937, 0.000136562, 0.000121538, 8.72727e-05, 0.000145672, 0.000125, 0.000138551, 0.000121429, 0.00011831, 0.000105556, 0.000121096, 0.000106216, 9.78667e-05, 9.73684e-05, 0.000107792, 0.000106154, 8.91139e-05, 8.35e-05, 0.000105679, 8.92683e-05, 0.000100482, 0.000100238, 0.000125176, 8.7907e-05, 8.16092e-05, 8.40909e-05, 8.29213e-05, 7.88889e-05, 9.45055e-05, 8.56522e-05, 8.47312e-05, 7.3617e-05, 9.72632e-05, 8.64583e-05, 7.4433e-05, 7.36735e-05, 7.93939e-05, 8.64e-05, ])
probability = array([0, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, -8, ])
avg_energy = array([-1.99664, -1.99624, -1.99625, -1.99604, -1.99597, -1.99609, -1.99605, -1.99598, -1.996, -1.99595, -1.99597, -1.99593, -1.99599, -1.99598, -1.99595, -1.99596, -1.99593, -1.99592, -1.99587, -1.99587, -1.99588, -1.9959, -1.99592, -1.99593, -1.99595, -1.99597, -1.99596, -1.99596, -1.99596, -1.99596, -1.99597, -1.99596, -1.99598, -1.99596, -1.99597, -1.99599, -1.99598, -1.99598, -1.99599, -1.99597, -1.99597, -1.99599, -1.996, -1.99601, -1.99601, -1.996, -1.99602, -1.99603, -1.99601, -1.99601, -1.996, -1.99599, -1.99601, -1.996, -1.99601, -1.99601, -1.99602, -1.99602, -1.99601, -1.99601, -1.99601, -1.996, -1.99598, -1.99597, -1.99598, -1.99599, -1.99598, -1.99598, -1.99596, -1.99596, -1.99596, -1.99596, -1.99596, -1.99596, -1.99597, -1.99598, -1.99597, -1.99597, -1.99598, -1.99599, -1.99598, -1.99599, -1.99599, -1.99598, -1.99597, -1.99597, -1.99598, -1.99598, -1.99599, -1.99599, -1.99599, -1.99599, -1.99599, -1.996, -1.99599, -1.99599, -1.996, -1.996, -1.996, -1.996, ])


sh = sinh(8);
ch = cosh(8);
energy_analytical = (-8*sh) / (ch + 3);
heat_capacity_analytical = 64*( ch / (ch + 3) - sh*sh / ( (ch + 3)**2) );
susceptibility_analytical = 8*(exp(-8) +1) / (ch + 3) - 1/(4*ch + 12)**2 * (8*exp(-8) + 16);

diff_e = (e_var*4 - heat_capacity_analytical)/heat_capacity_analytical;
diff_m = (m_var*4 - susceptibility_analytical)/susceptibility_analytical;
diff_energy = (avg_energy - energy_analytical)/energy_analytical;

print m_var[99]
print susceptibility_analytical

plt.plot(MC,diff_m)
plt.show()