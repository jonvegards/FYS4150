%% Two electron case, numerical and analytical together

psi_num= [0.00259, 0.00529598, 0.00811306, 0.0110359, 0.014059, 0.0171762, 0.0203812, 0.0236675, 0.027028, 0.0304556, 0.0339429, 0.0374822, 0.0410658, 0.0446857, 0.0483337, 0.0520016, 0.0556812, 0.0593641, 0.063042, 0.0667065, 0.0703494, 0.0739623, 0.0775372, 0.081066, 0.084541, 0.0879543, 0.0912985, 0.0945663, 0.0977508, 0.100845, 0.103843, 0.106738, 0.109524, 0.112197, 0.11475, 0.117179, 0.11948, 0.121649, 0.123681, 0.125575, 0.127327, 0.128934, 0.130395, 0.131709, 0.132874, 0.133889, 0.134755, 0.13547, 0.136037, 0.136455, 0.136726, 0.136851, 0.136832, 0.136673, 0.136374, 0.13594, 0.135373, 0.134676, 0.133854, 0.132911, 0.13185, 0.130675, 0.129393, 0.128006, 0.12652, 0.12494, 0.123272, 0.121519, 0.119687, 0.117782, 0.115809, 0.113772, 0.111678, 0.109532, 0.107338, 0.105102, 0.10283, 0.100525, 0.0981933, 0.0958395, 0.0934683, 0.0910841, 0.0886915, 0.0862947, 0.0838979, 0.0815051, 0.0791202, 0.0767468, 0.0743884, 0.0720483, 0.0697296, 0.0674354, 0.0651684, 0.0629311, 0.0607261, 0.0585555, 0.0564215, 0.0543258, 0.0522702, 0.0502562, 0.0482852, 0.0463584, 0.0444769, 0.0426415, 0.0408529, 0.0391119, 0.0374188, 0.035774, 0.0341776, 0.0326298, 0.0311306, 0.0296797, 0.0282769, 0.026922, 0.0256144, 0.0243537, 0.0231393, 0.0219705, 0.0208466, 0.0197669, 0.0187304, 0.0177364, 0.0167838, 0.0158718, 0.0149993, 0.0141653, 0.0133688, 0.0126087, 0.011884, 0.0111935, 0.0105362, 0.0099109, 0.00931663, 0.00875225, 0.00821669, 0.00770886, 0.00722769, 0.00677215, 0.00634119, 0.00593381, 0.00554901, 0.00518581, 0.00484324, 0.0045204, 0.00421636, 0.00393024, 0.00366118, 0.00340836, 0.00317097, 0.00294823, 0.00273939, 0.00254372, 0.00236052, 0.00218913, 0.00202889, 0.00187919, 0.00173943, 0.00160905, 0.0014875, 0.00137427, 0.00126886, 0.00117079, 0.00107962, 0.000994935, 0.000916314, 0.000843383, 0.000775759, 0.000713111, 0.000655121, 0.000601476, 0.000551869, 0.000506043, 0.000463733, 0.000424697, 0.000388705, 0.000355541, 0.000325003, 0.00029691, 0.000271077, 0.000247338, 0.000225537, 0.000205532, 0.000187187, 0.000170369, 0.00015497, 0.000140878, 0.000127991, 0.000116206, 0.000105443, 9.56242e-05, 8.66558e-05, 7.84817e-05, 7.10385e-05, 6.42683e-05, 5.81037e-05, 5.24956e-05, 4.73979e-05, 4.27733e-05, 3.85759e-05, 3.4771e-05, 3.13183e-05, 2.81942e-05, 2.5366e-05, 2.28093e-05, 2.04901e-05, 1.84003e-05, 1.65156e-05, 1.48181e-05, 1.32773e-05, 1.18966e-05, 1.06503e-05, 9.53234e-06, 8.52008e-06, 7.61619e-06, 6.80509e-06, 6.07023e-06, 5.41299e-06, 4.82677e-06, 4.30521e-06, 3.82953e-06, 3.40728e-06, 3.03048e-06, 2.6964e-06, 2.39098e-06, 2.12489e-06, 1.88092e-06, 1.66847e-06, 1.4748e-06, 1.31178e-06, 1.15474e-06, 1.02356e-06, 9.02971e-07, 7.95456e-07, 6.96138e-07, 6.15345e-07, 5.40111e-07, 4.75553e-07, 4.13841e-07, 3.63482e-07, 3.12243e-07, 2.68899e-07, 2.30493e-07, 1.96343e-07, 1.69213e-07, 1.36085e-07, 1.0873e-07, 8.69318e-08, 6.05657e-08, 4.2072e-08, 2.12523e-08, ];
psi_anal= [0, 0.048739, 0.0996602, 0.152671, 0.207673, 0.264559, 0.323216, 0.383525, 0.445362, 0.508596, 0.573093, 0.638712, 0.70531, 0.77274, 0.840853, 0.909495, 0.978512, 1.04775, 1.11705, 1.18625, 1.2552, 1.32375, 1.39173, 1.45899, 1.52539, 1.59078, 1.655, 1.71793, 1.77942, 1.83934, 1.89756, 1.95397, 2.00844, 2.06087, 2.11116, 2.1592, 2.20491, 2.24821, 2.28902, 2.32727, 2.36291, 2.39587, 2.42612, 2.45362, 2.47835, 2.50027, 2.51938, 2.53567, 2.54914, 2.55981, 2.56768, 2.57278, 2.57515, 2.57481, 2.57181, 2.5662, 2.55803, 2.54737, 2.53427, 2.51881, 2.50107, 2.48111, 2.45902, 2.43489, 2.40881, 2.38086, 2.35114, 2.31974, 2.28677, 2.25231, 2.21646, 2.17934, 2.14103, 2.10163, 2.06124, 2.01997, 1.9779, 1.93514, 1.89178, 1.84791, 1.80362, 1.759, 1.71414, 1.66912, 1.62402, 1.57892, 1.5339, 1.48902, 1.44436, 1.39998, 1.35595, 1.31232, 1.26914, 1.22648, 1.18438, 1.14289, 1.10204, 1.06188, 1.02244, 0.98376, 0.945859, 0.908767, 0.872506, 0.837097, 0.802556, 0.768896, 0.73613, 0.704267, 0.673311, 0.643267, 0.614138, 0.585921, 0.558614, 0.532214, 0.506713, 0.482103, 0.458376, 0.435519, 0.413522, 0.392369, 0.372046, 0.352539, 0.333829, 0.315901, 0.298735, 0.282313, 0.266616, 0.251624, 0.237318, 0.223677, 0.21068, 0.198308, 0.18654, 0.175354, 0.164732, 0.154651, 0.145092, 0.136036, 0.127462, 0.11935, 0.111682, 0.104439, 0.0976028, 0.091155, 0.0850783, 0.0793556, 0.0739702, 0.068906, 0.0641474, 0.0596791, 0.0554867, 0.0515558, 0.0478729, 0.0444247, 0.0411988, 0.0381828, 0.0353652, 0.0327347, 0.0302807, 0.027993, 0.0258618, 0.0238779, 0.0220322, 0.0203164, 0.0187224, 0.0172427, 0.01587, 0.0145974, 0.0134185, 0.0123271, 0.0113174, 0.0103839, 0.00952144, 0.00872521, 0.00799059, 0.00731327, 0.00668922, 0.00611462, 0.00558592, 0.00509977, 0.00465305, 0.00424285, 0.00386641, 0.0035212, 0.00320484, 0.0029151, 0.00264993, 0.0024074, 0.00218572, 0.00198323, 0.0017984, 0.0016298, 0.0014761, 0.00133607, 0.00120859, 0.0010926, 0.000987143, 0.000891319, 0.000804306, 0.000725345, 0.000653737, 0.00058884, 0.000530062, 0.000476862, 0.00042874, 0.000385241, 0.000345945, 0.000310468, 0.000278461, 0.000249603, 0.000223599, 0.000200184, 0.000179112, 0.000160161, 0.000143129, 0.000127831, 0.000114099, 0.000101781, 9.07378e-05, 8.08441e-05, 7.19859e-05, 6.40596e-05, 5.69718e-05, 5.06378e-05, 4.49809e-05, 3.9932e-05, 3.54285e-05, 3.1414e-05, 2.78377e-05, 2.46538e-05, 2.18209e-05, 1.9302e-05, 1.70636e-05, 1.50758e-05, 1.33116e-05, 1.17468e-05, 1.03597e-05, 9.13097e-06, 8.04317e-06, 7.08073e-06, 6.22974e-06, 5.47775e-06, 4.81366e-06, 4.22756e-06, 3.71061e-06, 3.25493e-06, 2.85351e-06, 2.50011e-06, 2.18917e-06, 1.91576e-06, 1.6755e-06, 1.46451e-06, ];
rho= [0, 0.047619, 0.0952381, 0.142857, 0.190476, 0.238095, 0.285714, 0.333333, 0.380952, 0.428571, 0.47619, 0.52381, 0.571429, 0.619048, 0.666667, 0.714286, 0.761905, 0.809524, 0.857143, 0.904762, 0.952381, 1, 1.04762, 1.09524, 1.14286, 1.19048, 1.2381, 1.28571, 1.33333, 1.38095, 1.42857, 1.47619, 1.52381, 1.57143, 1.61905, 1.66667, 1.71429, 1.7619, 1.80952, 1.85714, 1.90476, 1.95238, 2, 2.04762, 2.09524, 2.14286, 2.19048, 2.2381, 2.28571, 2.33333, 2.38095, 2.42857, 2.47619, 2.52381, 2.57143, 2.61905, 2.66667, 2.71429, 2.7619, 2.80952, 2.85714, 2.90476, 2.95238, 3, 3.04762, 3.09524, 3.14286, 3.19048, 3.2381, 3.28571, 3.33333, 3.38095, 3.42857, 3.47619, 3.52381, 3.57143, 3.61905, 3.66667, 3.71429, 3.7619, 3.80952, 3.85714, 3.90476, 3.95238, 4, 4.04762, 4.09524, 4.14286, 4.19048, 4.2381, 4.28571, 4.33333, 4.38095, 4.42857, 4.47619, 4.52381, 4.57143, 4.61905, 4.66667, 4.71429, 4.7619, 4.80952, 4.85714, 4.90476, 4.95238, 5, 5.04762, 5.09524, 5.14286, 5.19048, 5.2381, 5.28571, 5.33333, 5.38095, 5.42857, 5.47619, 5.52381, 5.57143, 5.61905, 5.66667, 5.71429, 5.7619, 5.80952, 5.85714, 5.90476, 5.95238, 6, 6.04762, 6.09524, 6.14286, 6.19048, 6.2381, 6.28571, 6.33333, 6.38095, 6.42857, 6.47619, 6.52381, 6.57143, 6.61905, 6.66667, 6.71429, 6.7619, 6.80952, 6.85714, 6.90476, 6.95238, 7, 7.04762, 7.09524, 7.14286, 7.19048, 7.2381, 7.28571, 7.33333, 7.38095, 7.42857, 7.47619, 7.52381, 7.57143, 7.61905, 7.66667, 7.71429, 7.7619, 7.80952, 7.85714, 7.90476, 7.95238, 8, 8.04762, 8.09524, 8.14286, 8.19048, 8.2381, 8.28571, 8.33333, 8.38095, 8.42857, 8.47619, 8.52381, 8.57143, 8.61905, 8.66667, 8.71429, 8.7619, 8.80952, 8.85714, 8.90476, 8.95238, 9, 9.04762, 9.09524, 9.14286, 9.19048, 9.2381, 9.28571, 9.33333, 9.38095, 9.42857, 9.47619, 9.52381, 9.57143, 9.61905, 9.66667, 9.71429, 9.7619, 9.80952, 9.85714, 9.90476, 9.95238, 10, 10.0476, 10.0952, 10.1429, 10.1905, 10.2381, 10.2857, 10.3333, 10.381, 10.4286, 10.4762, 10.5238, 10.5714, 10.619, 10.6667, 10.7143, 10.7619, 10.8095, 10.8571, 10.9048, 10.9524, 11, 11.0476, 11.0952, 11.1429, 11.1905, 11.2381, 11.2857, 11.3333, 11.381, 11.4286, 11.4762, 11.5238, 11.5714, 11.619, 11.6667, 11.7143, 11.7619, 11.8095, 11.8571, 11.9048, 11.9524, ];
norm = trapz(psi_anal.*psi_anal) % We must divide psi_anal by this factor in order to normalize it.

figure(1)
plot(rho(2:251),psi_num .*psi_num)
hold('on')
plot(rho(2:251),psi_anal(2:251).*psi_anal(2:251)./norm)
set(0,'DefaultAxesFontSize',15)
legend('Analytical','Numerical')
title('Relative distance between two electrons, numerical and analytical solution','FontSize',16,'Interpreter','latex')
xlabel('Distance $$\rho$$','Interpreter','latex')
ylabel('Probability $$|\Psi|^2$$','Interpreter','latex')